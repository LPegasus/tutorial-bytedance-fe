<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>update page by underscore</title>
  <script src="https://unpkg.pstatp.com/underscore/1.12.0/underscore.js"></script>
</head>

<body>
  <div id="root"></div>
  <script type="text/javascript">
    (function () {
      // L4-react 运行 rushx start
      // 打开 http://localhost:8000/samples/underscore-demo.html

      /**
       * 用 underscore 编译字符串模板，生成模板函数
       */
      const tpl = _.template('<button id="btn-1" style="background-color: #333; color: #EFEFEF; border: none; padding: 6px 0; width: 50px;"><%= count%></button>');

      /**
       * 选取 root 作为渲染节点
       */
      const root = document.querySelector('#root');

      /**
       * 触发重绘的调用函数
       */
      const render = (count) => {
        const html = tpl({ count });
        root.innerHTML = html;
      }

      let count = 0;

      /**
       * 事件代理，避免 变更时，DOM 不存在或销毁导致 click 事件不可用
       */
      document.body.addEventListener('click', function (evt) {
        if (evt.target.tagName === 'BUTTON') {
          evt.target.addEventListener('click', () => console.log({ v: count }));
          render(++count);
        }
      });
      // document.querySelector('button').addEventListener('click', () => {
      //   render(++count);
      // });

      render(count);
    })();
  </script>
</body>

</html>
